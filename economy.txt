Folder Structure
--------------------------------------------------
./
    main.py
    .gitignore
    poetry.lock
    pytest.ini
    pyproject.toml
    README.md
    tests/
        __init__.py
        test_reports.py
        conftest.py
        test_csv_tools.py
        test_arg_parser.py
        test_shortcuts.py
        test_cli_tools.py
    core/
        __init__.py
        csv_tools.py
        shortcuts.py
        cli_tools.py
        arg_parser.py
        logger.py
        reports.py
        defined_reports/
            __init__.py
            average_gdp.py
            dev_performance.py
    csv/
        employees2.csv
        employees1.csv
        economic1.csv
        economic2.csv


File Contents
--------------------------------------------------


main.py
File type: .py
import sys
from csv import Error as csv_Error
from pathlib import Path

from core import (
    ArgParser,
    CsvReader,
    ReportRegistry,
    print_table,
    setup_logging,
)
from core.defined_reports import AveragePerformanceReport


def main():
    """Entry point for the application."""

    setup_logging()

    ReportRegistry.register_report("performance", AveragePerformanceReport)

    parser = ArgParser()
    args = parser.parse_args()

    all_data = []
    for file_path in args.files:
        path = Path(file_path)
        reader = CsvReader(path)

        try:
            print(reader.check_csv_file_valid)
        except (FileNotFoundError, ValueError, csv_Error) as e:
            print(f"Error: {e}")
            sys.exit(1)

        data = reader.load_csv
        all_data.extend(data)

    try:
        report_instance = ReportRegistry.get_report(args.report)
        result = report_instance.generate(all_data)

        print_table(
            result, title=f"Report: {args.report.upper()} ({len(all_data)} records)"
        )

    except ValueError as e:
        print(f"Error: {e}")
        sys.exit(1)


if __name__ == "__main__":
    main()


--------------------------------------------------
File End
--------------------------------------------------


.gitignore
File type: no extension
# Byte-compiled / optimized / DLL files
__pycache__/
*.py[codz]
*$py.class

# C extensions
*.so

# Distribution / packaging
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
share/python-wheels/
*.egg-info/
.installed.cfg
*.egg
MANIFEST

# PyInstaller
#  Usually these files are written by a python script from a template
#  before PyInstaller builds the exe, so as to inject date/other infos into it.
*.manifest
*.spec

# Installer logs
pip-log.txt
pip-delete-this-directory.txt

# Unit test / coverage reports
htmlcov/
.tox/
.nox/
.coverage
.coverage.*
.cache
nosetests.xml
coverage.xml
*.cover
*.py.cover
.hypothesis/
.pytest_cache/
cover/

# Translations
*.mo
*.pot

# Django stuff:
*.log
local_settings.py
db.sqlite3
db.sqlite3-journal

# Flask stuff:
instance/
.webassets-cache

# Scrapy stuff:
.scrapy

# Sphinx documentation
docs/_build/

# PyBuilder
.pybuilder/
target/

# Jupyter Notebook
.ipynb_checkpoints

# IPython
profile_default/
ipython_config.py

# pyenv
#   For a library or package, you might want to ignore these files since the code is
#   intended to run in multiple environments; otherwise, check them in:
# .python-version

# pipenv
#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.
#   However, in case of collaboration, if having platform-specific dependencies or dependencies
#   having no cross-platform support, pipenv may install dependencies that don't work, or not
#   install all needed dependencies.
#Pipfile.lock

# UV
#   Similar to Pipfile.lock, it is generally recommended to include uv.lock in version control.
#   This is especially recommended for binary packages to ensure reproducibility, and is more
#   commonly ignored for libraries.
#uv.lock

# poetry
#   Similar to Pipfile.lock, it is generally recommended to include poetry.lock in version control.
#   This is especially recommended for binary packages to ensure reproducibility, and is more
#   commonly ignored for libraries.
#   https://python-poetry.org/docs/basic-usage/#commit-your-poetrylock-file-to-version-control
#poetry.lock
#poetry.toml

# pdm
#   Similar to Pipfile.lock, it is generally recommended to include pdm.lock in version control.
#   pdm recommends including project-wide configuration in pdm.toml, but excluding .pdm-python.
#   https://pdm-project.org/en/latest/usage/project/#working-with-version-control
#pdm.lock
#pdm.toml
.pdm-python
.pdm-build/

# pixi
#   Similar to Pipfile.lock, it is generally recommended to include pixi.lock in version control.
#pixi.lock
#   Pixi creates a virtual environment in the .pixi directory, just like venv module creates one
#   in the .venv directory. It is recommended not to include this directory in version control.
.pixi

# PEP 582; used by e.g. github.com/David-OConnor/pyflow and github.com/pdm-project/pdm
__pypackages__/

# Celery stuff
celerybeat-schedule
celerybeat.pid

# SageMath parsed files
*.sage.py

# Environments
.env
.envrc
.venv
env/
venv/
ENV/
env.bak/
venv.bak/

# Spyder project settings
.spyderproject
.spyproject

# Rope project settings
.ropeproject

# mkdocs documentation
/site

# mypy
.mypy_cache/
.dmypy.json
dmypy.json

# Pyre type checker
.pyre/

# pytype static type analyzer
.pytype/

# Cython debug symbols
cython_debug/

# PyCharm
#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can
#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore
#  and can be added to the global gitignore or merged into this file.  For a more nuclear
#  option (not recommended) you can uncomment the following to ignore the entire idea folder.
#.idea/

# Abstra
# Abstra is an AI-powered process automation framework.
# Ignore directories containing user credentials, local state, and settings.
# Learn more at https://abstra.io/docs
.abstra/

# Visual Studio Code
#  Visual Studio Code specific template is maintained in a separate VisualStudioCode.gitignore 
#  that can be found at https://github.com/github/gitignore/blob/main/Global/VisualStudioCode.gitignore
#  and can be added to the global gitignore or merged into this file. However, if you prefer, 
#  you could uncomment the following to ignore the entire vscode folder
# .vscode/

# Ruff stuff:
.ruff_cache/

# PyPI configuration file
.pypirc

# Cursor
#  Cursor is an AI-powered code editor. `.cursorignore` specifies files/directories to
#  exclude from AI features like autocomplete and code analysis. Recommended for sensitive data
#  refer to https://docs.cursor.com/context/ignore-files
.cursorignore
.cursorindexingignore

# Marimo
marimo/_static/
marimo/_lsp/
__marimo__/


--------------------------------------------------
File End
--------------------------------------------------


poetry.lock
File type: .lock
# This file is automatically @generated by Poetry 2.2.1 and should not be changed by hand.

[[package]]
name = "black"
version = "25.11.0"
description = "The uncompromising code formatter."
optional = false
python-versions = ">=3.9"
groups = ["dev"]
files = [
    {file = "black-25.11.0-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:ec311e22458eec32a807f029b2646f661e6859c3f61bc6d9ffb67958779f392e"},
    {file = "black-25.11.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:1032639c90208c15711334d681de2e24821af0575573db2810b0763bcd62e0f0"},
    {file = "black-25.11.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:0c0f7c461df55cf32929b002335883946a4893d759f2df343389c4396f3b6b37"},
    {file = "black-25.11.0-cp310-cp310-win_amd64.whl", hash = "sha256:f9786c24d8e9bd5f20dc7a7f0cdd742644656987f6ea6947629306f937726c03"},
    {file = "black-25.11.0-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:895571922a35434a9d8ca67ef926da6bc9ad464522a5fe0db99b394ef1c0675a"},
    {file = "black-25.11.0-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:cb4f4b65d717062191bdec8e4a442539a8ea065e6af1c4f4d36f0cdb5f71e170"},
    {file = "black-25.11.0-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:d81a44cbc7e4f73a9d6ae449ec2317ad81512d1e7dce7d57f6333fd6259737bc"},
    {file = "black-25.11.0-cp311-cp311-win_amd64.whl", hash = "sha256:7eebd4744dfe92ef1ee349dc532defbf012a88b087bb7ddd688ff59a447b080e"},
    {file = "black-25.11.0-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:80e7486ad3535636657aa180ad32a7d67d7c273a80e12f1b4bfa0823d54e8fac"},
    {file = "black-25.11.0-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:6cced12b747c4c76bc09b4db057c319d8545307266f41aaee665540bc0e04e96"},
    {file = "black-25.11.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:6cb2d54a39e0ef021d6c5eef442e10fd71fcb491be6413d083a320ee768329dd"},
    {file = "black-25.11.0-cp312-cp312-win_amd64.whl", hash = "sha256:ae263af2f496940438e5be1a0c1020e13b09154f3af4df0835ea7f9fe7bfa409"},
    {file = "black-25.11.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:0a1d40348b6621cc20d3d7530a5b8d67e9714906dfd7346338249ad9c6cedf2b"},
    {file = "black-25.11.0-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:51c65d7d60bb25429ea2bf0731c32b2a2442eb4bd3b2afcb47830f0b13e58bfd"},
    {file = "black-25.11.0-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:936c4dd07669269f40b497440159a221ee435e3fddcf668e0c05244a9be71993"},
    {file = "black-25.11.0-cp313-cp313-win_amd64.whl", hash = "sha256:f42c0ea7f59994490f4dccd64e6b2dd49ac57c7c84f38b8faab50f8759db245c"},
    {file = "black-25.11.0-cp314-cp314-macosx_10_15_x86_64.whl", hash = "sha256:35690a383f22dd3e468c85dc4b915217f87667ad9cce781d7b42678ce63c4170"},
    {file = "black-25.11.0-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:dae49ef7369c6caa1a1833fd5efb7c3024bb7e4499bf64833f65ad27791b1545"},
    {file = "black-25.11.0-cp314-cp314-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:5bd4a22a0b37401c8e492e994bce79e614f91b14d9ea911f44f36e262195fdda"},
    {file = "black-25.11.0-cp314-cp314-win_amd64.whl", hash = "sha256:aa211411e94fdf86519996b7f5f05e71ba34835d8f0c0f03c00a26271da02664"},
    {file = "black-25.11.0-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:a3bb5ce32daa9ff0605d73b6f19da0b0e6c1f8f2d75594db539fdfed722f2b06"},
    {file = "black-25.11.0-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:9815ccee1e55717fe9a4b924cae1646ef7f54e0f990da39a34fc7b264fcf80a2"},
    {file = "black-25.11.0-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:92285c37b93a1698dcbc34581867b480f1ba3a7b92acf1fe0467b04d7a4da0dc"},
    {file = "black-25.11.0-cp39-cp39-win_amd64.whl", hash = "sha256:43945853a31099c7c0ff8dface53b4de56c41294fa6783c0441a8b1d9bf668bc"},
    {file = "black-25.11.0-py3-none-any.whl", hash = "sha256:e3f562da087791e96cefcd9dda058380a442ab322a02e222add53736451f604b"},
    {file = "black-25.11.0.tar.gz", hash = "sha256:9a323ac32f5dc75ce7470501b887250be5005a01602e931a15e45593f70f6e08"},
]

[package.dependencies]
click = ">=8.0.0"
mypy-extensions = ">=0.4.3"
packaging = ">=22.0"
pathspec = ">=0.9.0"
platformdirs = ">=2"
pytokens = ">=0.3.0"

[package.extras]
colorama = ["colorama (>=0.4.3)"]
d = ["aiohttp (>=3.10)"]
jupyter = ["ipython (>=7.8.0)", "tokenize-rt (>=3.2.0)"]
uvloop = ["uvloop (>=0.15.2)"]

[[package]]
name = "click"
version = "8.3.1"
description = "Composable command line interface toolkit"
optional = false
python-versions = ">=3.10"
groups = ["dev"]
files = [
    {file = "click-8.3.1-py3-none-any.whl", hash = "sha256:981153a64e25f12d547d3426c367a4857371575ee7ad18df2a6183ab0545b2a6"},
    {file = "click-8.3.1.tar.gz", hash = "sha256:12ff4785d337a1bb490bb7e9c2b1ee5da3112e94a8622f26a6c77f5d2fc6842a"},
]

[package.dependencies]
colorama = {version = "*", markers = "platform_system == \"Windows\""}

[[package]]
name = "colorama"
version = "0.4.6"
description = "Cross-platform colored terminal text."
optional = false
python-versions = "!=3.0.*,!=3.1.*,!=3.2.*,!=3.3.*,!=3.4.*,!=3.5.*,!=3.6.*,>=2.7"
groups = ["dev"]
markers = "platform_system == \"Windows\" or sys_platform == \"win32\""
files = [
    {file = "colorama-0.4.6-py2.py3-none-any.whl", hash = "sha256:4f1d9991f5acc0ca119f9d443620b77f9d6b33703e51011c16baf57afb285fc6"},
    {file = "colorama-0.4.6.tar.gz", hash = "sha256:08695f5cb7ed6e0531a20572697297273c47b8cae5a63ffc6d6ed5c201be6e44"},
]

[[package]]
name = "coverage"
version = "7.12.0"
description = "Code coverage measurement for Python"
optional = false
python-versions = ">=3.10"
groups = ["dev"]
files = [
    {file = "coverage-7.12.0-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:32b75c2ba3f324ee37af3ccee5b30458038c50b349ad9b88cee85096132a575b"},
    {file = "coverage-7.12.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:cb2a1b6ab9fe833714a483a915de350abc624a37149649297624c8d57add089c"},
    {file = "coverage-7.12.0-cp310-cp310-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:5734b5d913c3755e72f70bf6cc37a0518d4f4745cde760c5d8e12005e62f9832"},
    {file = "coverage-7.12.0-cp310-cp310-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:b527a08cdf15753279b7afb2339a12073620b761d79b81cbe2cdebdb43d90daa"},
    {file = "coverage-7.12.0-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:9bb44c889fb68004e94cab71f6a021ec83eac9aeabdbb5a5a88821ec46e1da73"},
    {file = "coverage-7.12.0-cp310-cp310-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:4b59b501455535e2e5dde5881739897967b272ba25988c89145c12d772810ccb"},
    {file = "coverage-7.12.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:d8842f17095b9868a05837b7b1b73495293091bed870e099521ada176aa3e00e"},
    {file = "coverage-7.12.0-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:c5a6f20bf48b8866095c6820641e7ffbe23f2ac84a2efc218d91235e404c7777"},
    {file = "coverage-7.12.0-cp310-cp310-musllinux_1_2_riscv64.whl", hash = "sha256:5f3738279524e988d9da2893f307c2093815c623f8d05a8f79e3eff3a7a9e553"},
    {file = "coverage-7.12.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:e0d68c1f7eabbc8abe582d11fa393ea483caf4f44b0af86881174769f185c94d"},
    {file = "coverage-7.12.0-cp310-cp310-win32.whl", hash = "sha256:7670d860e18b1e3ee5930b17a7d55ae6287ec6e55d9799982aa103a2cc1fa2ef"},
    {file = "coverage-7.12.0-cp310-cp310-win_amd64.whl", hash = "sha256:f999813dddeb2a56aab5841e687b68169da0d3f6fc78ccf50952fa2463746022"},
    {file = "coverage-7.12.0-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:aa124a3683d2af98bd9d9c2bfa7a5076ca7e5ab09fdb96b81fa7d89376ae928f"},
    {file = "coverage-7.12.0-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:d93fbf446c31c0140208dcd07c5d882029832e8ed7891a39d6d44bd65f2316c3"},
    {file = "coverage-7.12.0-cp311-cp311-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:52ca620260bd8cd6027317bdd8b8ba929be1d741764ee765b42c4d79a408601e"},
    {file = "coverage-7.12.0-cp311-cp311-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:f3433ffd541380f3a0e423cff0f4926d55b0cc8c1d160fdc3be24a4c03aa65f7"},
    {file = "coverage-7.12.0-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:f7bbb321d4adc9f65e402c677cd1c8e4c2d0105d3ce285b51b4d87f1d5db5245"},
    {file = "coverage-7.12.0-cp311-cp311-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:22a7aade354a72dff3b59c577bfd18d6945c61f97393bc5fb7bd293a4237024b"},
    {file = "coverage-7.12.0-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:3ff651dcd36d2fea66877cd4a82de478004c59b849945446acb5baf9379a1b64"},
    {file = "coverage-7.12.0-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:31b8b2e38391a56e3cea39d22a23faaa7c3fc911751756ef6d2621d2a9daf742"},
    {file = "coverage-7.12.0-cp311-cp311-musllinux_1_2_riscv64.whl", hash = "sha256:297bc2da28440f5ae51c845a47c8175a4db0553a53827886e4fb25c66633000c"},
    {file = "coverage-7.12.0-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:6ff7651cc01a246908eac162a6a86fc0dbab6de1ad165dfb9a1e2ec660b44984"},
    {file = "coverage-7.12.0-cp311-cp311-win32.whl", hash = "sha256:313672140638b6ddb2c6455ddeda41c6a0b208298034544cfca138978c6baed6"},
    {file = "coverage-7.12.0-cp311-cp311-win_amd64.whl", hash = "sha256:a1783ed5bd0d5938d4435014626568dc7f93e3cb99bc59188cc18857c47aa3c4"},
    {file = "coverage-7.12.0-cp311-cp311-win_arm64.whl", hash = "sha256:4648158fd8dd9381b5847622df1c90ff314efbfc1df4550092ab6013c238a5fc"},
    {file = "coverage-7.12.0-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:29644c928772c78512b48e14156b81255000dcfd4817574ff69def189bcb3647"},
    {file = "coverage-7.12.0-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:8638cbb002eaa5d7c8d04da667813ce1067080b9a91099801a0053086e52b736"},
    {file = "coverage-7.12.0-cp312-cp312-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:083631eeff5eb9992c923e14b810a179798bb598e6a0dd60586819fc23be6e60"},
    {file = "coverage-7.12.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:99d5415c73ca12d558e07776bd957c4222c687b9f1d26fa0e1b57e3598bdcde8"},
    {file = "coverage-7.12.0-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:e949ebf60c717c3df63adb4a1a366c096c8d7fd8472608cd09359e1bd48ef59f"},
    {file = "coverage-7.12.0-cp312-cp312-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:6d907ddccbca819afa2cd014bc69983b146cca2735a0b1e6259b2a6c10be1e70"},
    {file = "coverage-7.12.0-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:b1518ecbad4e6173f4c6e6c4a46e49555ea5679bf3feda5edb1b935c7c44e8a0"},
    {file = "coverage-7.12.0-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:51777647a749abdf6f6fd8c7cffab12de68ab93aab15efc72fbbb83036c2a068"},
    {file = "coverage-7.12.0-cp312-cp312-musllinux_1_2_riscv64.whl", hash = "sha256:42435d46d6461a3b305cdfcad7cdd3248787771f53fe18305548cba474e6523b"},
    {file = "coverage-7.12.0-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:5bcead88c8423e1855e64b8057d0544e33e4080b95b240c2a355334bb7ced937"},
    {file = "coverage-7.12.0-cp312-cp312-win32.whl", hash = "sha256:dcbb630ab034e86d2a0f79aefd2be07e583202f41e037602d438c80044957baa"},
    {file = "coverage-7.12.0-cp312-cp312-win_amd64.whl", hash = "sha256:2fd8354ed5d69775ac42986a691fbf68b4084278710cee9d7c3eaa0c28fa982a"},
    {file = "coverage-7.12.0-cp312-cp312-win_arm64.whl", hash = "sha256:737c3814903be30695b2de20d22bcc5428fdae305c61ba44cdc8b3252984c49c"},
    {file = "coverage-7.12.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:47324fffca8d8eae7e185b5bb20c14645f23350f870c1649003618ea91a78941"},
    {file = "coverage-7.12.0-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:ccf3b2ede91decd2fb53ec73c1f949c3e034129d1e0b07798ff1d02ea0c8fa4a"},
    {file = "coverage-7.12.0-cp313-cp313-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:b365adc70a6936c6b0582dc38746b33b2454148c02349345412c6e743efb646d"},
    {file = "coverage-7.12.0-cp313-cp313-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:bc13baf85cd8a4cfcf4a35c7bc9d795837ad809775f782f697bf630b7e200211"},
    {file = "coverage-7.12.0-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:099d11698385d572ceafb3288a5b80fe1fc58bf665b3f9d362389de488361d3d"},
    {file = "coverage-7.12.0-cp313-cp313-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:473dc45d69694069adb7680c405fb1e81f60b2aff42c81e2f2c3feaf544d878c"},
    {file = "coverage-7.12.0-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:583f9adbefd278e9de33c33d6846aa8f5d164fa49b47144180a0e037f0688bb9"},
    {file = "coverage-7.12.0-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:b2089cc445f2dc0af6f801f0d1355c025b76c24481935303cf1af28f636688f0"},
    {file = "coverage-7.12.0-cp313-cp313-musllinux_1_2_riscv64.whl", hash = "sha256:950411f1eb5d579999c5f66c62a40961f126fc71e5e14419f004471957b51508"},
    {file = "coverage-7.12.0-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:b1aab7302a87bafebfe76b12af681b56ff446dc6f32ed178ff9c092ca776e6bc"},
    {file = "coverage-7.12.0-cp313-cp313-win32.whl", hash = "sha256:d7e0d0303c13b54db495eb636bc2465b2fb8475d4c8bcec8fe4b5ca454dfbae8"},
    {file = "coverage-7.12.0-cp313-cp313-win_amd64.whl", hash = "sha256:ce61969812d6a98a981d147d9ac583a36ac7db7766f2e64a9d4d059c2fe29d07"},
    {file = "coverage-7.12.0-cp313-cp313-win_arm64.whl", hash = "sha256:bcec6f47e4cb8a4c2dc91ce507f6eefc6a1b10f58df32cdc61dff65455031dfc"},
    {file = "coverage-7.12.0-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:459443346509476170d553035e4a3eed7b860f4fe5242f02de1010501956ce87"},
    {file = "coverage-7.12.0-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:04a79245ab2b7a61688958f7a855275997134bc84f4a03bc240cf64ff132abf6"},
    {file = "coverage-7.12.0-cp313-cp313t-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:09a86acaaa8455f13d6a99221d9654df249b33937b4e212b4e5a822065f12aa7"},
    {file = "coverage-7.12.0-cp313-cp313t-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:907e0df1b71ba77463687a74149c6122c3f6aac56c2510a5d906b2f368208560"},
    {file = "coverage-7.12.0-cp313-cp313t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:9b57e2d0ddd5f0582bae5437c04ee71c46cd908e7bc5d4d0391f9a41e812dd12"},
    {file = "coverage-7.12.0-cp313-cp313t-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:58c1c6aa677f3a1411fe6fb28ec3a942e4f665df036a3608816e0847fad23296"},
    {file = "coverage-7.12.0-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:4c589361263ab2953e3c4cd2a94db94c4ad4a8e572776ecfbad2389c626e4507"},
    {file = "coverage-7.12.0-cp313-cp313t-musllinux_1_2_i686.whl", hash = "sha256:91b810a163ccad2e43b1faa11d70d3cf4b6f3d83f9fd5f2df82a32d47b648e0d"},
    {file = "coverage-7.12.0-cp313-cp313t-musllinux_1_2_riscv64.whl", hash = "sha256:40c867af715f22592e0d0fb533a33a71ec9e0f73a6945f722a0c85c8c1cbe3a2"},
    {file = "coverage-7.12.0-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:68b0d0a2d84f333de875666259dadf28cc67858bc8fd8b3f1eae84d3c2bec455"},
    {file = "coverage-7.12.0-cp313-cp313t-win32.whl", hash = "sha256:73f9e7fbd51a221818fd11b7090eaa835a353ddd59c236c57b2199486b116c6d"},
    {file = "coverage-7.12.0-cp313-cp313t-win_amd64.whl", hash = "sha256:24cff9d1f5743f67db7ba46ff284018a6e9aeb649b67aa1e70c396aa1b7cb23c"},
    {file = "coverage-7.12.0-cp313-cp313t-win_arm64.whl", hash = "sha256:c87395744f5c77c866d0f5a43d97cc39e17c7f1cb0115e54a2fe67ca75c5d14d"},
    {file = "coverage-7.12.0-cp314-cp314-macosx_10_15_x86_64.whl", hash = "sha256:a1c59b7dc169809a88b21a936eccf71c3895a78f5592051b1af8f4d59c2b4f92"},
    {file = "coverage-7.12.0-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:8787b0f982e020adb732b9f051f3e49dd5054cebbc3f3432061278512a2b1360"},
    {file = "coverage-7.12.0-cp314-cp314-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:5ea5a9f7dc8877455b13dd1effd3202e0bca72f6f3ab09f9036b1bcf728f69ac"},
    {file = "coverage-7.12.0-cp314-cp314-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:fdba9f15849534594f60b47c9a30bc70409b54947319a7c4fd0e8e3d8d2f355d"},
    {file = "coverage-7.12.0-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:a00594770eb715854fb1c57e0dea08cce6720cfbc531accdb9850d7c7770396c"},
    {file = "coverage-7.12.0-cp314-cp314-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:5560c7e0d82b42eb1951e4f68f071f8017c824ebfd5a6ebe42c60ac16c6c2434"},
    {file = "coverage-7.12.0-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:d6c2e26b481c9159c2773a37947a9718cfdc58893029cdfb177531793e375cfc"},
    {file = "coverage-7.12.0-cp314-cp314-musllinux_1_2_i686.whl", hash = "sha256:6e1a8c066dabcde56d5d9fed6a66bc19a2883a3fe051f0c397a41fc42aedd4cc"},
    {file = "coverage-7.12.0-cp314-cp314-musllinux_1_2_riscv64.whl", hash = "sha256:f7ba9da4726e446d8dd8aae5a6cd872511184a5d861de80a86ef970b5dacce3e"},
    {file = "coverage-7.12.0-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:e0f483ab4f749039894abaf80c2f9e7ed77bbf3c737517fb88c8e8e305896a17"},
    {file = "coverage-7.12.0-cp314-cp314-win32.whl", hash = "sha256:76336c19a9ef4a94b2f8dc79f8ac2da3f193f625bb5d6f51a328cd19bfc19933"},
    {file = "coverage-7.12.0-cp314-cp314-win_amd64.whl", hash = "sha256:7c1059b600aec6ef090721f8f633f60ed70afaffe8ecab85b59df748f24b31fe"},
    {file = "coverage-7.12.0-cp314-cp314-win_arm64.whl", hash = "sha256:172cf3a34bfef42611963e2b661302a8931f44df31629e5b1050567d6b90287d"},
    {file = "coverage-7.12.0-cp314-cp314t-macosx_10_15_x86_64.whl", hash = "sha256:aa7d48520a32cb21c7a9b31f81799e8eaec7239db36c3b670be0fa2403828d1d"},
    {file = "coverage-7.12.0-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:90d58ac63bc85e0fb919f14d09d6caa63f35a5512a2205284b7816cafd21bb03"},
    {file = "coverage-7.12.0-cp314-cp314t-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:ca8ecfa283764fdda3eae1bdb6afe58bf78c2c3ec2b2edcb05a671f0bba7b3f9"},
    {file = "coverage-7.12.0-cp314-cp314t-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:874fe69a0785d96bd066059cd4368022cebbec1a8958f224f0016979183916e6"},
    {file = "coverage-7.12.0-cp314-cp314t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:5b3c889c0b8b283a24d721a9eabc8ccafcfc3aebf167e4cd0d0e23bf8ec4e339"},
    {file = "coverage-7.12.0-cp314-cp314t-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:8bb5b894b3ec09dcd6d3743229dc7f2c42ef7787dc40596ae04c0edda487371e"},
    {file = "coverage-7.12.0-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:79a44421cd5fba96aa57b5e3b5a4d3274c449d4c622e8f76882d76635501fd13"},
    {file = "coverage-7.12.0-cp314-cp314t-musllinux_1_2_i686.whl", hash = "sha256:33baadc0efd5c7294f436a632566ccc1f72c867f82833eb59820ee37dc811c6f"},
    {file = "coverage-7.12.0-cp314-cp314t-musllinux_1_2_riscv64.whl", hash = "sha256:c406a71f544800ef7e9e0000af706b88465f3573ae8b8de37e5f96c59f689ad1"},
    {file = "coverage-7.12.0-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:e71bba6a40883b00c6d571599b4627f50c360b3d0d02bfc658168936be74027b"},
    {file = "coverage-7.12.0-cp314-cp314t-win32.whl", hash = "sha256:9157a5e233c40ce6613dead4c131a006adfda70e557b6856b97aceed01b0e27a"},
    {file = "coverage-7.12.0-cp314-cp314t-win_amd64.whl", hash = "sha256:e84da3a0fd233aeec797b981c51af1cabac74f9bd67be42458365b30d11b5291"},
    {file = "coverage-7.12.0-cp314-cp314t-win_arm64.whl", hash = "sha256:01d24af36fedda51c2b1aca56e4330a3710f83b02a5ff3743a6b015ffa7c9384"},
    {file = "coverage-7.12.0-py3-none-any.whl", hash = "sha256:159d50c0b12e060b15ed3d39f87ed43d4f7f7ad40b8a534f4dd331adbb51104a"},
    {file = "coverage-7.12.0.tar.gz", hash = "sha256:fc11e0a4e372cb5f282f16ef90d4a585034050ccda536451901abfb19a57f40c"},
]

[package.extras]
toml = ["tomli ; python_full_version <= \"3.11.0a6\""]

[[package]]
name = "flake8"
version = "7.3.0"
description = "the modular source code checker: pep8 pyflakes and co"
optional = false
python-versions = ">=3.9"
groups = ["dev"]
files = [
    {file = "flake8-7.3.0-py2.py3-none-any.whl", hash = "sha256:b9696257b9ce8beb888cdbe31cf885c90d31928fe202be0889a7cdafad32f01e"},
    {file = "flake8-7.3.0.tar.gz", hash = "sha256:fe044858146b9fc69b551a4b490d69cf960fcb78ad1edcb84e7fbb1b4a8e3872"},
]

[package.dependencies]
mccabe = ">=0.7.0,<0.8.0"
pycodestyle = ">=2.14.0,<2.15.0"
pyflakes = ">=3.4.0,<3.5.0"

[[package]]
name = "iniconfig"
version = "2.3.0"
description = "brain-dead simple config-ini parsing"
optional = false
python-versions = ">=3.10"
groups = ["dev"]
files = [
    {file = "iniconfig-2.3.0-py3-none-any.whl", hash = "sha256:f631c04d2c48c52b84d0d0549c99ff3859c98df65b3101406327ecc7d53fbf12"},
    {file = "iniconfig-2.3.0.tar.gz", hash = "sha256:c76315c77db068650d49c5b56314774a7804df16fee4402c1f19d6d15d8c4730"},
]

[[package]]
name = "mccabe"
version = "0.7.0"
description = "McCabe checker, plugin for flake8"
optional = false
python-versions = ">=3.6"
groups = ["dev"]
files = [
    {file = "mccabe-0.7.0-py2.py3-none-any.whl", hash = "sha256:6c2d30ab6be0e4a46919781807b4f0d834ebdd6c6e3dca0bda5a15f863427b6e"},
    {file = "mccabe-0.7.0.tar.gz", hash = "sha256:348e0240c33b60bbdf4e523192ef919f28cb2c3d7d5c7794f74009290f236325"},
]

[[package]]
name = "mypy-extensions"
version = "1.1.0"
description = "Type system extensions for programs checked with the mypy type checker."
optional = false
python-versions = ">=3.8"
groups = ["dev"]
files = [
    {file = "mypy_extensions-1.1.0-py3-none-any.whl", hash = "sha256:1be4cccdb0f2482337c4743e60421de3a356cd97508abadd57d47403e94f5505"},
    {file = "mypy_extensions-1.1.0.tar.gz", hash = "sha256:52e68efc3284861e772bbcd66823fde5ae21fd2fdb51c62a211403730b916558"},
]

[[package]]
name = "packaging"
version = "25.0"
description = "Core utilities for Python packages"
optional = false
python-versions = ">=3.8"
groups = ["dev"]
files = [
    {file = "packaging-25.0-py3-none-any.whl", hash = "sha256:29572ef2b1f17581046b3a2227d5c611fb25ec70ca1ba8554b24b0e69331a484"},
    {file = "packaging-25.0.tar.gz", hash = "sha256:d443872c98d677bf60f6a1f2f8c1cb748e8fe762d2bf9d3148b5599295b0fc4f"},
]

[[package]]
name = "pathspec"
version = "0.12.1"
description = "Utility library for gitignore style pattern matching of file paths."
optional = false
python-versions = ">=3.8"
groups = ["dev"]
files = [
    {file = "pathspec-0.12.1-py3-none-any.whl", hash = "sha256:a0d503e138a4c123b27490a4f7beda6a01c6f288df0e4a8b79c7eb0dc7b4cc08"},
    {file = "pathspec-0.12.1.tar.gz", hash = "sha256:a482d51503a1ab33b1c67a6c3813a26953dbdc71c31dacaef9a838c4e29f5712"},
]

[[package]]
name = "platformdirs"
version = "4.5.0"
description = "A small Python package for determining appropriate platform-specific dirs, e.g. a `user data dir`."
optional = false
python-versions = ">=3.10"
groups = ["dev"]
files = [
    {file = "platformdirs-4.5.0-py3-none-any.whl", hash = "sha256:e578a81bb873cbb89a41fcc904c7ef523cc18284b7e3b3ccf06aca1403b7ebd3"},
    {file = "platformdirs-4.5.0.tar.gz", hash = "sha256:70ddccdd7c99fc5942e9fc25636a8b34d04c24b335100223152c2803e4063312"},
]

[package.extras]
docs = ["furo (>=2025.9.25)", "proselint (>=0.14)", "sphinx (>=8.2.3)", "sphinx-autodoc-typehints (>=3.2)"]
test = ["appdirs (==1.4.4)", "covdefaults (>=2.3)", "pytest (>=8.4.2)", "pytest-cov (>=7)", "pytest-mock (>=3.15.1)"]
type = ["mypy (>=1.18.2)"]

[[package]]
name = "pluggy"
version = "1.6.0"
description = "plugin and hook calling mechanisms for python"
optional = false
python-versions = ">=3.9"
groups = ["dev"]
files = [
    {file = "pluggy-1.6.0-py3-none-any.whl", hash = "sha256:e920276dd6813095e9377c0bc5566d94c932c33b27a3e3945d8389c374dd4746"},
    {file = "pluggy-1.6.0.tar.gz", hash = "sha256:7dcc130b76258d33b90f61b658791dede3486c3e6bfb003ee5c9bfb396dd22f3"},
]

[package.extras]
dev = ["pre-commit", "tox"]
testing = ["coverage", "pytest", "pytest-benchmark"]

[[package]]
name = "pycodestyle"
version = "2.14.0"
description = "Python style guide checker"
optional = false
python-versions = ">=3.9"
groups = ["dev"]
files = [
    {file = "pycodestyle-2.14.0-py2.py3-none-any.whl", hash = "sha256:dd6bf7cb4ee77f8e016f9c8e74a35ddd9f67e1d5fd4184d86c3b98e07099f42d"},
    {file = "pycodestyle-2.14.0.tar.gz", hash = "sha256:c4b5b517d278089ff9d0abdec919cd97262a3367449ea1c8b49b91529167b783"},
]

[[package]]
name = "pyflakes"
version = "3.4.0"
description = "passive checker of Python programs"
optional = false
python-versions = ">=3.9"
groups = ["dev"]
files = [
    {file = "pyflakes-3.4.0-py2.py3-none-any.whl", hash = "sha256:f742a7dbd0d9cb9ea41e9a24a918996e8170c799fa528688d40dd582c8265f4f"},
    {file = "pyflakes-3.4.0.tar.gz", hash = "sha256:b24f96fafb7d2ab0ec5075b7350b3d2d2218eab42003821c06344973d3ea2f58"},
]

[[package]]
name = "pygments"
version = "2.19.2"
description = "Pygments is a syntax highlighting package written in Python."
optional = false
python-versions = ">=3.8"
groups = ["dev"]
files = [
    {file = "pygments-2.19.2-py3-none-any.whl", hash = "sha256:86540386c03d588bb81d44bc3928634ff26449851e99741617ecb9037ee5ec0b"},
    {file = "pygments-2.19.2.tar.gz", hash = "sha256:636cb2477cec7f8952536970bc533bc43743542f70392ae026374600add5b887"},
]

[package.extras]
windows-terminal = ["colorama (>=0.4.6)"]

[[package]]
name = "pytest"
version = "9.0.1"
description = "pytest: simple powerful testing with Python"
optional = false
python-versions = ">=3.10"
groups = ["dev"]
files = [
    {file = "pytest-9.0.1-py3-none-any.whl", hash = "sha256:67be0030d194df2dfa7b556f2e56fb3c3315bd5c8822c6951162b92b32ce7dad"},
    {file = "pytest-9.0.1.tar.gz", hash = "sha256:3e9c069ea73583e255c3b21cf46b8d3c56f6e3a1a8f6da94ccb0fcf57b9d73c8"},
]

[package.dependencies]
colorama = {version = ">=0.4", markers = "sys_platform == \"win32\""}
iniconfig = ">=1.0.1"
packaging = ">=22"
pluggy = ">=1.5,<2"
pygments = ">=2.7.2"

[package.extras]
dev = ["argcomplete", "attrs (>=19.2)", "hypothesis (>=3.56)", "mock", "requests", "setuptools", "xmlschema"]

[[package]]
name = "pytest-cov"
version = "7.0.0"
description = "Pytest plugin for measuring coverage."
optional = false
python-versions = ">=3.9"
groups = ["dev"]
files = [
    {file = "pytest_cov-7.0.0-py3-none-any.whl", hash = "sha256:3b8e9558b16cc1479da72058bdecf8073661c7f57f7d3c5f22a1c23507f2d861"},
    {file = "pytest_cov-7.0.0.tar.gz", hash = "sha256:33c97eda2e049a0c5298e91f519302a1334c26ac65c1a483d6206fd458361af1"},
]

[package.dependencies]
coverage = {version = ">=7.10.6", extras = ["toml"]}
pluggy = ">=1.2"
pytest = ">=7"

[package.extras]
testing = ["process-tests", "pytest-xdist", "virtualenv"]

[[package]]
name = "pytokens"
version = "0.3.0"
description = "A Fast, spec compliant Python 3.14+ tokenizer that runs on older Pythons."
optional = false
python-versions = ">=3.8"
groups = ["dev"]
files = [
    {file = "pytokens-0.3.0-py3-none-any.whl", hash = "sha256:95b2b5eaf832e469d141a378872480ede3f251a5a5041b8ec6e581d3ac71bbf3"},
    {file = "pytokens-0.3.0.tar.gz", hash = "sha256:2f932b14ed08de5fcf0b391ace2642f858f1394c0857202959000b68ed7a458a"},
]

[package.extras]
dev = ["black", "build", "mypy", "pytest", "pytest-cov", "setuptools", "tox", "twine", "wheel"]

[[package]]
name = "tabulate"
version = "0.9.0"
description = "Pretty-print tabular data"
optional = false
python-versions = ">=3.7"
groups = ["main"]
files = [
    {file = "tabulate-0.9.0-py3-none-any.whl", hash = "sha256:024ca478df22e9340661486f85298cff5f6dcdba14f3813e8830015b9ed1948f"},
    {file = "tabulate-0.9.0.tar.gz", hash = "sha256:0095b12bf5966de529c0feb1fa08671671b3368eec77d7ef7ab114be2c068b3c"},
]

[package.extras]
widechars = ["wcwidth"]

[metadata]
lock-version = "2.1"
python-versions = ">=3.13"
content-hash = "2384841224a61bc07f80297e8b02acfbc40d8313ebe60bf74dc9ad835b6e9219"


--------------------------------------------------
File End
--------------------------------------------------


pytest.ini
File type: .ini
[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts =
    --tb=short
    --cov=core
    --cov-report=term-missing


--------------------------------------------------
File End
--------------------------------------------------


pyproject.toml
File type: .toml
[project]
name = "csv-dev-report"
version = "0.1.0"
description = ""
authors = [
    {name = "rukiqq",email = "mitaka@duck.com"}
]
readme = "README.md"
requires-python = ">=3.13"
dependencies = [
    "tabulate (>=0.9.0,<0.10.0)"
]

[dependency-groups]
dev = [
    "black (>=25.11.0,<26.0.0)",
    "pytest (>=9.0.1,<10.0.0)",
    "pytest-cov (>=7.0.0,<8.0.0)",
    "flake8 (>=7.3.0,<8.0.0)"
]

[tool.poetry]
package-mode = false

[build-system]
requires = ["poetry-core>=2.0.0,<3.0.0"]
build-backend = "poetry.core.masonry.api"


--------------------------------------------------
File End
--------------------------------------------------


README.md
File type: .md
# csv-dev-report

This project is for generating reports from CSV files.
It's currently supports performance report, though new reports can be added by creating BaseReport child class and register it in ReportRegistry with ReportRegistry.register_report.

## Usage

```bash
poetry install
python main.py --files <paths_to_csv_files> --report <report_name>
```

## Examples

```bash
python main.py --files csv/employees1.csv csv/employees2.csv --report performance
```

## Testing

```bash
python -m pytest
```

## Screenshots

### Basic usage
![alt](https://files.catbox.moe/80kn2b.png)

![alt](https://files.catbox.moe/7sjesj.png)


### Some error handling
![alt](https://files.catbox.moe/uj2i3s.png)


### Tests & flake8
![alt](https://files.catbox.moe/p10jgw.png)


### Logs
![alt](https://files.catbox.moe/t9xemk.png)


--------------------------------------------------
File End
--------------------------------------------------


tests/__init__.py
File type: .py


--------------------------------------------------
File End
--------------------------------------------------


tests/test_reports.py
File type: .py
from pytest import raises as pt_raises

from core import ReportRegistry
from core.defined_reports import AveragePerformanceReport


class TestReportRegistry:
    """Tests for ReportRegistry."""

    def test_register_report(self):
        ReportRegistry.register_report("test_report", AveragePerformanceReport)

        assert "test_report" in ReportRegistry.available_reports

    def test_get_registered_report(self):
        ReportRegistry.register_report("performance", AveragePerformanceReport)
        report = ReportRegistry.get_report("performance")

        assert isinstance(report, AveragePerformanceReport)

    def test_get_nonexistent_report_raises_error(self):
        """Test that getting non-existent report raises ValueError."""

        with pt_raises(ValueError, match="isn't found"):
            ReportRegistry.get_report("nonexistent_report")


class TestAveragePerformanceReport:
    """Tests for AveragePerformanceReport class."""

    def test_generate_report_valid_data(self, perf_data):
        report = AveragePerformanceReport()
        result = report.generate(perf_data)

        assert len(result) == 3
        assert all("position" in item for item in result)
        assert all("performance" in item for item in result)

    def test_generate_report_calculates_average_correct(self, perf_data):
        report = AveragePerformanceReport()
        result = report.generate(perf_data)

        backend_result = next(
            (res for res in result if res["position"] == "Backend Developer"), None
        )
        assert backend_result is not None
        assert backend_result["performance"] == 4.7

        frontend_result = next(
            (res for res in result if res["position"] == "Frontend Developer"), None
        )
        assert frontend_result is not None
        assert frontend_result["performance"] == 4.8

        qa_result = next(
            (res for res in result if res["position"] == "QA Engineer"), None
        )
        assert qa_result is not None
        assert qa_result["performance"] == 4.5

    def test_generate_report_sorting_order(self, perf_data):
        """Test that results are sorted by performance descending."""

        report = AveragePerformanceReport()
        result = report.generate(perf_data)

        assert result[0]["position"] == "Frontend Developer"
        assert result[0]["performance"] == 4.8

        assert result[1]["position"] == "Backend Developer"
        assert result[1]["performance"] == 4.7

        assert result[2]["position"] == "QA Engineer"
        assert result[2]["performance"] == 4.5

    def test_generate_report_empty_data(self):
        report = AveragePerformanceReport()
        result = report.generate([])

        assert result == []

    def test_generate_report_invalid_data(self, invalid_perf_data):
        report = AveragePerformanceReport()
        result = report.generate(invalid_perf_data)

        assert result == []

    def test_generate_report_single_position(self, perf_data):
        data = perf_data[:1]
        report = AveragePerformanceReport()
        result = report.generate(data)

        assert len(result) == 1
        assert result[0]["position"] == "Backend Developer"
        assert result[0]["performance"] == 4.8

    def test_generate_report_mixed_valid_invalid(self, mixed_perf_data):
        """Test report with mixed valid and invalid performance values."""

        report = AveragePerformanceReport()
        result = report.generate(mixed_perf_data)

        assert len(result) == 2

        dev_result = next(
            (res for res in result if res["position"] == "Developer"), None
        )
        assert dev_result is not None
        assert dev_result["performance"] == 4.7

        tester_result = next(
            (res for res in result if res["position"] == "Tester"), None
        )
        assert tester_result is not None
        assert tester_result["performance"] == 4.6

    def test_generate_report_rounding(self, float_three_perf_data):
        """Test that performance values are rounded to 2 decimal places."""

        report = AveragePerformanceReport()
        result = report.generate(float_three_perf_data)

        assert len(result) == 1
        assert result[0]["performance"] == 4.5


--------------------------------------------------
File End
--------------------------------------------------


tests/conftest.py
File type: .py
import csv
import tempfile
from pathlib import Path
from typing import Iterator

import pytest


@pytest.fixture(name="perf_data")
def _sample_data_avg_perf_report() -> list[dict[str, str]]:
    """Valid data for testing AveragePerformanceReport."""

    return [
        {"name": "John", "position": "Backend Developer", "performance": "4.8"},
        {"name": "Jane", "position": "Backend Developer", "performance": "4.6"},
        {"name": "Bob", "position": "Frontend Developer", "performance": "4.7"},
        {"name": "Alice", "position": "Frontend Developer", "performance": "4.9"},
        {"name": "Mike", "position": "QA Engineer", "performance": "4.5"},
    ]


@pytest.fixture(name="invalid_perf_data")
def _invalid_data_avg_perf_report() -> list[dict[str, str]]:
    """Invalid data for testing AveragePerformanceReport."""

    return [{"name": "John", "position": "Developer", "performance": "invalid"}]


@pytest.fixture(name="mixed_perf_data")
def _mixed_valid_invalid_data_avg_perf_report() -> list[dict[str, str]]:
    """Mixed valid and invalid data for testing AveragePerformanceReport."""

    return [
        {"name": "John", "position": "Developer", "performance": "4.5"},
        {"name": "Jane", "position": "Developer", "performance": "invalid"},
        {"name": "Bob", "position": "Developer", "performance": "4.9"},
        {"name": "Alice", "position": "Tester", "performance": ""},
        {"name": "Mike", "position": "Tester", "performance": "4.6"},
    ]


@pytest.fixture(name="float_three_perf_data")
def _float_three_decimal_data_avg_perf_report() -> list[dict[str, str]]:
    """Data with 3 decimal places for testing AveragePerformanceReport."""

    return [
        {"name": "John", "position": "Developer", "performance": "4.333"},
        {"name": "Jane", "position": "Developer", "performance": "4.666"},
    ]


@pytest.fixture
def valid_csv_file(perf_data) -> Iterator[Path]:
    """Creating a temporary CSV file for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".csv", delete=False) as f:
        writer = csv.DictWriter(f, fieldnames=["name", "position", "performance"])
        writer.writeheader()
        writer.writerows(perf_data)
        temp_path = Path(f.name)

    yield temp_path

    temp_path.unlink()


@pytest.fixture
def invalid_csv_file() -> Iterator[Path]:
    """Creating a temporary invalid CSV file for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".csv", delete=False) as f:
        f.write("invalid,csv,content\nwith no proper structure")
        temp_path = Path(f.name)

    yield temp_path

    temp_path.unlink()


@pytest.fixture
def empty_csv_file() -> Iterator[Path]:
    """Creating a temporary empty CSV file for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".csv", delete=False) as f:
        f.write("empty,csv,file")
        temp_path = Path(f.name)

    yield temp_path

    temp_path.unlink()


@pytest.fixture
def empty_value_csv_file() -> Iterator[Path]:
    """Creating a temporary CSV file with empty value in row for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".csv", delete=False) as f:
        f.write("name,position,performance\n")
        f.write("John,Developer,\n")
        temp_path = Path(f.name)

    yield temp_path

    temp_path.unlink()


@pytest.fixture
def non_csv_file() -> Iterator[Path]:
    """Creating a temporary non-CSV file for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".txt", delete=False) as f:
        f.write("This is not a CSV file")
        temp_path = Path(f.name)

    yield temp_path

    temp_path.unlink()


@pytest.fixture
def nonexistent_file() -> Path:
    """Path to a non-existent file."""
    return Path("nonexistent_file.csv")


@pytest.fixture
def semicolon_csv_file() -> Iterator[Path]:
    """Creating a temporary semicolon CSV file for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".csv", delete=False) as f:
        f.write("name;position;performance\n")
        f.write("John;Developer;4.6\n")
        f.write("Jane;Designer;4.9\n")
        temp_path = Path(f.name)

    yield temp_path

    temp_path.unlink()


@pytest.fixture
def quotes_csv_file() -> Iterator[Path]:
    """Creating a temporary CSV file with quotes for testing csv_tools."""

    with tempfile.NamedTemporaryFile(mode="w", suffix=".csv", delete=False) as f:
        f.write("name,position,performance\n")
        f.write('John,Fake "Developer",4.5\n')
        temp_path = Path(f.name)

    yield temp_path
    temp_path.unlink()


@pytest.fixture
def valid_args() -> list[str]:
    """Valid arguments for testing arg_parser."""

    return ["--files", "file.csv", "--report", "performance"]


@pytest.fixture
def valid_multiple_files_args() -> list[str]:
    """Valid multi-files arguments for testing arg_parser."""

    return ["--files", "file1.csv", "file2.csv", "file3.csv", "--report", "performance"]


@pytest.fixture
def no_files_args() -> list[str]:
    """Invalid arguments without --files for testing arg_parser."""

    return ["--report", "performance"]


@pytest.fixture
def no_report_args() -> list[str]:
    """Invalid arguments without --report for testing arg_parser."""

    return ["--files", "file.csv"]


@pytest.fixture
def abbreviated_args() -> list[str]:
    """Abbreviated arguments for testing arg_parser."""

    return ["--f", "file.csv", "--report", "performance"]


@pytest.fixture
def duplicate_args() -> list[str]:
    """Duplicate arguments for testing arg_parser."""

    return ["--files", "file1.csv", "--files", "file2.csv", "--report", "performance"]


@pytest.fixture
def help_arg() -> list[str]:
    """Help argument for testing arg_parser."""

    return ["--help"]


@pytest.fixture
def unknown_args() -> list[str]:
    """Unknown arguments for testing arg_parser."""

    return ["--files", "file.csv", "--report", "performance", "--unknown", "value"]


@pytest.fixture
def zero_files_args() -> list[str]:
    """Zero-files arguments for testing arg_parser."""

    return ["--files", "--report", "performance"]


--------------------------------------------------
File End
--------------------------------------------------


tests/test_csv_tools.py
File type: .py
from csv import Error as csv_Error

from pytest import raises as pt_raises

from core import CsvReader


class TestCsvReader:
    """Tests for CsvReader."""

    def test_check_csv_file_valid(self, valid_csv_file):
        """Test validation of a valid CSV file."""

        reader = CsvReader(valid_csv_file)
        result = reader.check_csv_file_valid

        assert "is valid" in result
        assert "5 rows" in result

    def test_check_csv_file_not_found(self, nonexistent_file):
        """Test that non-existent file raises FileNotFoundError."""

        reader = CsvReader(nonexistent_file)

        with pt_raises(FileNotFoundError, match="does not exist"):
            _ = reader.check_csv_file_valid

    def test_check_non_csv_file(self, non_csv_file):
        """Test that non-CSV file raises ValueError."""

        reader = CsvReader(non_csv_file)

        with pt_raises(ValueError, match="is not a CSV file"):
            _ = reader.check_csv_file_valid

    def test_check_empty_csv_file(self, empty_csv_file):
        """Test that empty CSV file raises csv.Error."""

        reader = CsvReader(empty_csv_file)

        with pt_raises(csv_Error, match="is empty"):
            _ = reader.check_csv_file_valid

    def test_check_invalid_csv_structure(self, invalid_csv_file):
        """Test that CSV with inconsistent columns raises csv.Error."""

        reader = CsvReader(invalid_csv_file)

        with pt_raises(csv_Error, match="More or less columns"):
            _ = reader.check_csv_file_valid

    def test_check_empty_value_in_row(self, empty_value_csv_file):
        """Test that empty value in CSV file row raises csv.Error."""

        reader = CsvReader(empty_value_csv_file)

        with pt_raises(csv_Error, match="Empty value in row"):
            _ = reader.check_csv_file_valid

    def test_load_csv_returns_list_of_dicts(self, valid_csv_file):
        reader = CsvReader(valid_csv_file)
        data = reader.load_csv

        assert isinstance(data, list)
        assert len(data) == 5
        assert all(isinstance(row, dict) for row in data)

    def test_load_csv_correct_data(self, valid_csv_file):
        reader = CsvReader(valid_csv_file)
        data = reader.load_csv

        assert data[0]["name"] == "John"
        assert data[0]["position"] == "Backend Developer"
        assert data[0]["performance"] == "4.8"
        assert data[1]["name"] == "Jane"
        assert data[1]["position"] == "Backend Developer"
        assert data[1]["performance"] == "4.6"

    def test_load_csv_with_custom_delimiter(self, semicolon_csv_file):
        reader = CsvReader(semicolon_csv_file, delimiter=";")
        data = reader.load_csv

        assert len(data) == 2
        assert data[0]["name"] == "John"
        assert data[0]["position"] == "Developer"

    def test_csv_reader_with_quotes(self, quotes_csv_file):
        """Test CSV reader handles quoted fields."""

        reader = CsvReader(quotes_csv_file)
        data = reader.load_csv

        assert len(data) == 1
        assert data[0]["position"] == 'Fake "Developer"'

    def test_check_csv_file_valid_called_multiple_times(self, valid_csv_file):
        reader = CsvReader(valid_csv_file)

        result1 = reader.check_csv_file_valid
        result2 = reader.check_csv_file_valid

        assert result1 == result2

    def test_load_csv_called_multiple_times(self, valid_csv_file):
        reader = CsvReader(valid_csv_file)

        data1 = reader.load_csv
        data2 = reader.load_csv

        assert data1 == data2
        assert len(data1) == 5


--------------------------------------------------
File End
--------------------------------------------------


tests/test_arg_parser.py
File type: .py
from pytest import raises as pt_raises

from core import ArgParser


class TestArgParser:
    """Tests for ArgParser class."""

    def test_parse_single_file(self, valid_args):
        parser = ArgParser()
        args = parser.parse_args(valid_args)

        assert args.files == ["file.csv"]
        assert args.report == "performance"

    def test_parse_multiple_files(self, valid_multiple_files_args):
        parser = ArgParser()
        args = parser.parse_args(valid_multiple_files_args)

        assert len(args.files) == 3
        assert args.files == ["file1.csv", "file2.csv", "file3.csv"]
        assert args.report == "performance"

    def test_missing_files_argument_raises_error(self, no_files_args):
        """Test that missing --files raises SystemExit."""

        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args(no_files_args)

    def test_missing_report_argument_raises_error(self, no_report_args):
        """Test that missing --report raises SystemExit."""

        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args(no_report_args)

    def test_missing_all_arguments_raises_error(self):
        """Test that missing all arguments raises SystemExit."""

        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args([])

    def test_abbreviation_not_allowed(self, abbreviated_args):
        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args(abbreviated_args)

    def test_duplicate_argument_raises_error(self, duplicate_args):
        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args(duplicate_args)

    def test_help_argument(self, help_arg):
        parser = ArgParser()
        with pt_raises(SystemExit) as exc_info:
            parser.parse_args(help_arg)

        assert exc_info.value.code == 0

    def test_unknown_argument_raises_error(self, unknown_args):
        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args(unknown_args)

    def test_files_without_values_raises_error(self, zero_files_args):
        parser = ArgParser()
        with pt_raises(SystemExit):
            parser.parse_args(zero_files_args)


--------------------------------------------------
File End
--------------------------------------------------


tests/test_shortcuts.py
File type: .py
from pytest import raises as pt_raises

from core import convert_to_number, is_numeric


class TestIsNumeric:
    """Tests for is_numeric function."""

    def test_is_numeric_with_integer_string(self):
        assert is_numeric("42") is True
        assert is_numeric("0") is True
        assert is_numeric("100") is True

    def test_is_numeric_with_float_string(self):
        assert is_numeric("3.14") is True
        assert is_numeric("0.5") is True
        assert is_numeric("99.99") is True

    def test_is_numeric_with_negative_numbers(self):
        assert is_numeric("-10") is True
        assert is_numeric("-3.14") is True
        assert is_numeric("-0.5") is True

    def test_is_numeric_with_zero(self):
        assert is_numeric("0") is True
        assert is_numeric("0.0") is True
        assert is_numeric("-0") is True

    def test_is_numeric_with_non_numeric_string(self):
        assert is_numeric("abc") is False
        assert is_numeric("hello") is False
        assert is_numeric("test123") is False

    def test_is_numeric_with_empty_string(self):
        assert is_numeric("") is False

    def test_is_numeric_with_whitespace(self):
        assert is_numeric("  ") is False
        assert is_numeric("\n") is False
        assert is_numeric("\t") is False

    def test_is_numeric_with_special_characters(self):
        assert is_numeric("$100") is False
        assert is_numeric("10%") is False
        assert is_numeric("#5") is False

    def test_is_numeric_with_mixed_content(self):
        """Test with mixed numeric and non-numeric."""

        assert is_numeric("123abc") is False
        assert is_numeric("12.34.56") is False
        assert is_numeric("1 2 3") is False

    def test_is_numeric_with_actual_numbers(self):
        assert is_numeric(42) is True
        assert is_numeric(3.14) is True
        assert is_numeric(-10) is True


class TestConvertToNumber:
    """Tests for convert_to_number function."""

    def test_convert_integer_string(self):
        result = convert_to_number("42")

        assert result == 42
        assert isinstance(result, int)

    def test_convert_float_string(self):
        result = convert_to_number("3.14")

        assert result == 3.14
        assert isinstance(result, float)

    def test_convert_zero(self):
        result = convert_to_number("0")

        assert result == 0
        assert isinstance(result, int)

    def test_convert_negative_integer(self):
        result = convert_to_number("-10")

        assert result == -10
        assert isinstance(result, int)

    def test_convert_negative_float(self):
        result = convert_to_number("-2.5")

        assert result == -2.5
        assert isinstance(result, float)

    def test_convert_large_numbers(self):
        result = convert_to_number("1000000")
        assert result == 1000000
        assert isinstance(result, int)

        result = convert_to_number("999.999")
        assert result == 999.999
        assert isinstance(result, float)

    def test_convert_small_decimals(self):
        result = convert_to_number("0.001")

        assert result == 0.001
        assert isinstance(result, float)

    def test_convert_invalid_string_raises_error(self):
        """Test that invalid string raises ValueError."""

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("abc")

    def test_convert_empty_string_raises_error(self):
        """Test that empty string raises ValueError."""

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("")

    def test_convert_whitespace_raises_error(self):
        """Test that whitespace raises ValueError."""

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("   ")

    def test_convert_special_characters_raises_error(self):
        """Test that special characters raise ValueError."""

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("$100")

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("10%")

    def test_convert_mixed_content_raises_error(self):
        """Test that mixed content raises ValueError."""

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("123abc")

        with pt_raises(ValueError, match="Cannot convert value"):
            convert_to_number("12.34.56")

    def test_convert_preserves_type_int(self):
        """Test that integers without decimal point return int."""

        result = convert_to_number("100")
        assert isinstance(result, int)

    def test_convert_preserves_type_float(self):
        """Test that numbers with decimal point return float."""

        result = convert_to_number("100.0")
        assert isinstance(result, float)


--------------------------------------------------
File End
--------------------------------------------------


tests/test_cli_tools.py
File type: .py
from core import print_table


class TestPrintTable:
    """Tests for print_table function."""

    def test_print_table_with_valid_data(self, capsys, perf_data):
        print_table(perf_data)
        captured = capsys.readouterr()

        assert "John" in captured.out
        assert "Jane" in captured.out
        assert "name" in captured.out
        assert "position" in captured.out
        assert "performance" in captured.out
        assert "4.8" in captured.out

    def test_print_table_with_title(self, capsys, perf_data):
        title = "Test Results"
        print_table(perf_data, title=title)
        captured = capsys.readouterr()

        assert title in captured.out
        assert "=" * len(title) in captured.out
        assert "John" in captured.out

    def test_print_table_empty_data(self, capsys):
        print_table([])
        captured = capsys.readouterr()

        assert "No data to display" in captured.out

    def test_print_table_single_row(self, capsys, perf_data):
        data = perf_data[:1]
        print_table(data)
        captured = capsys.readouterr()

        assert "Backend Developer" in captured.out
        assert "4.8" in captured.out

    def test_print_table_grid_format(self, capsys, perf_data):
        """Test that table uses grid format."""

        print_table(perf_data)
        captured = capsys.readouterr()

        assert "+" in captured.out
        assert "|" in captured.out


--------------------------------------------------
File End
--------------------------------------------------


core/__init__.py
File type: .py
__all__ = (
    "ArgParser",
    "BaseReport",
    "CsvReader",
    "ReportRegistry",
    "convert_to_number",
    "is_numeric",
    "log",
    "get_logger",
    "print_table",
    "setup_logging",
)


from .arg_parser import ArgParser
from .cli_tools import print_table
from .csv_tools import CsvReader
from .logger import log, get_logger, setup_logging
from .reports import BaseReport, ReportRegistry
from .shortcuts import convert_to_number, is_numeric


--------------------------------------------------
File End
--------------------------------------------------


core/csv_tools.py
File type: .py
import csv
from pathlib import Path

from .logger import log


class CsvReader:
    def __init__(self, file: Path, delimiter: str = ","):
        self.file = file
        self.delimiter = delimiter

    @property
    @log
    def check_csv_file_valid(self) -> str:
        """
        Checking if csv file exists.

        Returns:
            Valid log info-string.

        Raises:
            FileNotFoundError: If csv file does not exist.
            ValueError: If file is not a csv file.
            csv.Error: If file validation fails.
        """

        if not self.file.is_file():
            error_msg = f"File {self.file} does not exist!"
            raise FileNotFoundError(error_msg)

        if not self.file.suffix == ".csv":
            error_msg = f"File {self.file} is not a CSV file!"
            raise ValueError(error_msg)

        with open(self.file, "r", encoding="utf-8") as csvfile:
            reader = csv.reader(csvfile, delimiter=self.delimiter)
            header = next(reader)
            header_count = len(header)
            rows = list(reader)

            if len(rows) == 0:
                error_msg = f"CSV file {self.file} is empty!"
                raise csv.Error(error_msg)

            for row in rows:
                if len(row) != header_count:
                    error_msg = f"More or less columns than headers in row: {row}"
                    raise csv.Error(error_msg)
                for value in row:
                    if not value:
                        error_msg = f"Empty value in row: {row}"
                        raise csv.Error(error_msg)

            return f"CSV file {self.file} is valid with {len(rows)} rows."

    @property
    @log
    def load_csv(self) -> list[dict[str, str]]:
        """
        Loading CSV file.

        Returns: List of dictionaries from CSV file.
        """

        with open(self.file, "r", encoding="utf-8") as f:
            reader = csv.DictReader(f, delimiter=self.delimiter)
            data = list(reader)

        return data


--------------------------------------------------
File End
--------------------------------------------------


core/shortcuts.py
File type: .py
from typing import Any

from .logger import log


@log
def is_numeric(value: Any) -> bool:
    """
    Checking if value is numeric.

    Returns:
        True if the value is numeric, False otherwise.
    """

    try:
        float(value)
        return True
    except ValueError:
        return False


@log
def convert_to_number(value: Any) -> int | float:
    """
    Converting value into numeric.

    Returns:
        Numeric value (int or float).

    Raises:
        ValueError: If value cannot be converted.
    """

    try:
        if "." in value:
            result = float(value)
            return result
        else:
            result = int(value)
            return result
    except ValueError:
        error_msg = f"Cannot convert value {value} to numeric."
        raise ValueError(error_msg)


--------------------------------------------------
File End
--------------------------------------------------


core/cli_tools.py
File type: .py
from tabulate import tabulate

from .logger import log


@log
def print_table(data: list[dict], title: str = "") -> None:
    """
    Printing data as a table to console.

    Args:
        data: List of dictionaries to display.
        title: Optional title for the table.
    """

    if not data:
        print("No data to display.")
        return

    if title:
        print(f"\n{title}")
        print("=" * len(title))

    print(
        tabulate(
            data,
            headers="keys",
            tablefmt="grid",
            numalign="right",
            stralign="left",
        )
    )
    print()


--------------------------------------------------
File End
--------------------------------------------------


core/arg_parser.py
File type: .py
import argparse


class OnceAction(argparse.Action):
    """Action that allows argument to be specified only once."""

    def __call__(self, parser, namespace, values, option_string=None):
        if getattr(namespace, self.dest, None) is not None:
            parser.error(f"Argument {option_string}: not allowed more than once")
        setattr(namespace, self.dest, values)


class ArgParser(argparse.ArgumentParser):
    """Parsing arguments."""

    def __init__(self):
        super(ArgParser, self).__init__(
            description="Filtering and aggregating CSV files.",
            allow_abbrev=False,
        )
        self.add_argument(
            "--files",
            nargs="+",
            required=True,
            action=OnceAction,
            help="Path to CSV files.",
        )
        self.add_argument(
            "--report",
            required=True,
            action=OnceAction,
            help="Creating <report-name> with given files.",
        )


--------------------------------------------------
File End
--------------------------------------------------


core/logger.py
File type: .py
import inspect
import logging
from functools import wraps
from pathlib import Path
from typing import Callable, Optional


def setup_logging(
    level: int = logging.DEBUG,
    log_to_file: bool = True,
    log_to_console: bool = False,
    log_dir: str = "logs",
) -> None:
    """
    Configuring logging for the application.

    Args:
        level: Logging level (default: DEBUG).
        log_to_file: Whether to log to file (default: True).
        log_to_console: Whether to log to console (default: False).
        log_dir: Directory for log files (default: "logs").
    """

    log_path = Path(log_dir)
    log_path.mkdir(exist_ok=True)
    formatter = logging.Formatter(
        fmt="[%(asctime)s.%(msecs)03d] %(levelname)-7s - %(message)s",
        datefmt="%Y-%m-%d %H:%M:%S",
    )

    root_logger = logging.getLogger()
    root_logger.setLevel(level)

    root_logger.handlers = []

    if log_to_file:
        from datetime import datetime

        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        log_file = log_path / f"app_{timestamp}.log"

        file_handler = logging.FileHandler(log_file, encoding="utf-8")
        file_handler.setLevel(level)
        file_handler.setFormatter(formatter)
        root_logger.addHandler(file_handler)

    if log_to_console:
        console_handler = logging.StreamHandler()
        console_handler.setLevel(level)
        console_handler.setFormatter(formatter)
        root_logger.addHandler(console_handler)


def get_logger(name: str) -> logging.Logger:
    """
    Getting a logger instance for the given module name.

    Args:
        name: Module name (usually __name__).

    Returns:
        Logger instance.
    """

    return logging.getLogger(name)


def _get_function_info(func: Callable) -> tuple[str, int]:
    """
    Extract function location information.

    Args:
        func: Function to extract info from.

    Returns:
        Tuple of (module_name, line_number).
    """

    func_module = func.__module__.split(".")[-1]

    try:
        func_line = inspect.getsourcelines(func)[1]
    except (OSError, TypeError):
        func_line = 0

    return func_module, func_line


def _get_doc_first_line(func: Callable) -> str:
    """
    Extract first non-empty line from function docstring.

    Args:
        func: Function to extract docstring from.

    Returns:
        First line of docstring or function name.
    """

    docstring = func.__doc__

    if not docstring:
        return func.__name__

    lines = docstring.split("\n")
    for line in lines:
        stripped = line.strip()
        if stripped:
            return stripped

    return func.__name__


def _create_wrapper(
    func: Callable, logger: logging.Logger, func_module: str, func_line: int
) -> Callable:
    """
    Creating wrapper function for logging.

    Args:
        func: Function to wrap.
        logger: Logger instance to use.
        func_module: Module name.
        func_line: Line number.

    Returns:
        Wrapped function.
    """

    @wraps(func)
    def wrapper(*args, **kwargs):
        doc_first_line = _get_doc_first_line(func)
        func_identifier = f"{func_module}:{func_line} {func.__qualname__}"

        logger.debug(f"[{func_identifier}] Start {doc_first_line}")
        logger.debug(f"[{func_identifier}] args={args}, kwargs={kwargs}")

        try:
            result = func(*args, **kwargs)
            logger.debug(f"[{func_identifier}] Completed successfully")
            return result
        except Exception as e:
            logger.exception(f"[{func_identifier}] Exception raised: {str(e)}")
            raise

    return wrapper


def log(_func: Optional[Callable] = None, *, logger: Optional[logging.Logger] = None):
    """
    Decorating function for logging purposes.

    Can be used with or without parameters:
        @log
        def func(): ...

        @log()
        def func(): ...

        @log(logger=custom_logger)
        def func(): ...

    Args:
        _func: Function to decorate
        logger: Optional logger instance (default: module logger)

    Returns:
        Decorated function
    """

    def decorator_log(func):
        func_module, func_line = _get_function_info(func)
        nonlocal logger

        if logger is None:
            logger = get_logger(func.__module__)

        return _create_wrapper(func, logger, func_module, func_line)

    if _func is None:
        return decorator_log
    else:
        return decorator_log(_func)


--------------------------------------------------
File End
--------------------------------------------------


core/reports.py
File type: .py
from abc import ABC, abstractmethod
from typing import Any

from .logger import log


class BaseReport(ABC):
    """Base report class."""

    @abstractmethod
    def generate(self, data: list[dict[str, Any]]) -> list[dict[str, Any]]:
        """
        Generate report from data.

        Args:
            data: list of dictionaries with some data.

        Returns:
            List of dictionaries for further operations.
        """

        raise NotImplementedError


class ReportRegMeta(type):
    """Metaclass for report registry."""

    @property
    def available_reports(cls) -> list[str]:
        """
        Getting available reports.

        Returns:
            List of available report names.
        """
        return list(cls._reports)  # type: ignore[attr-defined]


class ReportRegistry(metaclass=ReportRegMeta):
    """Registry of available reports."""

    _reports: dict["str", type[BaseReport]] = {}

    @classmethod
    @log
    def get_report(cls, report_name: str) -> BaseReport:
        """
        Getting report instance.

        Args:
            report_name: report name.

        Returns:
            Report class instance.

        Raises:
            ValueError: If report name is not found.
        """

        if report_name not in cls._reports:
            error_msg = (
                f"Report '{report_name}' isn't found. "
                f"Available reports: {', '.join(cls._reports)}".rstrip()
            )
            raise ValueError(error_msg)

        return cls._reports[report_name]()

    @classmethod
    @log
    def register_report(
        cls, report_name: str, report_class: type[BaseReport]
    ) -> type[BaseReport]:
        """
        Registering report class.

        Args:
            report_name: report name.
            report_class: report class.

        Returns:
            Registered report class.
        """

        cls._reports[report_name] = report_class
        return report_class


--------------------------------------------------
File End
--------------------------------------------------


core/defined_reports/__init__.py
File type: .py
__all__ = ("AveragePerformanceReport",)

from .dev_performance import AveragePerformanceReport


--------------------------------------------------
File End
--------------------------------------------------


core/defined_reports/average_gdp.py
File type: .py


--------------------------------------------------
File End
--------------------------------------------------


core/defined_reports/dev_performance.py
File type: .py
from collections import defaultdict
from typing import Any

from core import BaseReport, convert_to_number, is_numeric, log


class AveragePerformanceReport(BaseReport):
    """Report for average performances by dev's position."""

    @log
    def generate(self, data: list[dict[str, Any]]) -> list[dict[str, Any]]:
        """
        Generating report with developers performance by position.

        Args:
            data: List of dictionaries with products data.

        Returns:
            List of dictionaries with brands and their avf ratings,
            sorted by rating(desc).
        """

        position_perf = defaultdict(list)

        for developer in data:
            position = developer["position"]
            performance = developer["performance"]

            if not is_numeric(performance):
                continue

            performance = convert_to_number(performance)
            position_perf[position].append(performance)

        report_data = []
        for position, performances in position_perf.items():
            avg_performance = sum(performances) / len(performances)
            report_data.append(
                {"position": position, "performance": round(avg_performance, 2)}
            )

        report_data.sort(key=lambda x: x["performance"], reverse=True)

        return report_data


--------------------------------------------------
File End
--------------------------------------------------


csv/employees2.csv
File type: .csv
name,position,completed_tasks,performance,skills,team,experience_years
Alex Ivanov,Backend Developer,45,4.8,"Python, Django, PostgreSQL, Docker",API Team,5
Maria Petrova,Frontend Developer,38,4.7,"React, TypeScript, Redux, CSS",Web Team,4
John Smith,Data Scientist,29,4.6,"Python, ML, SQL, Pandas",AI Team,3
Anna Lee,DevOps Engineer,52,4.9,"AWS, Kubernetes, Terraform, Ansible",Infrastructure Team,6
Mike Brown,QA Engineer,41,4.5,"Selenium, Jest, Cypress, Postman",Testing Team,4
Sarah Johnson,Fullstack Developer,47,4.7,"JavaScript, Node.js, React, MongoDB",Web Team,5

--------------------------------------------------
File End
--------------------------------------------------


csv/employees1.csv
File type: .csv
name,position,completed_tasks,performance,skills,team,experience_years
David Chen,Mobile Developer,36,4.6,"Swift, Kotlin, React Native, iOS",Mobile Team,3
Elena Popova,Backend Developer,43,4.8,"Java, Spring Boot, MySQL, Redis",API Team,4
Chris Wilson,DevOps Engineer,39,4.7,"Docker, Jenkins, GitLab CI, AWS",Infrastructure Team,5
Olga Kuznetsova,Frontend Developer,42,4.6,"Vue.js, JavaScript, Webpack, Sass",Web Team,3
Robert Kim,Data Engineer,34,4.7,"Python, Apache Spark, Airflow, Kafka",Data Team,4
Julia Martin,QA Engineer,38,4.5,"Playwright, Jest, API Testing",Testing Team,3
Tom Anderson,Backend Developer,49,4.9,"Go, Microservices, gRPC, PostgreSQL",API Team,7
Lisa Wang,Mobile Developer,33,4.6,"Flutter, Dart, Android, Firebase",Mobile Team,2
Mark Thompson,Data Scientist,31,4.7,"R, Python, TensorFlow, SQL",AI Team,4

--------------------------------------------------
File End
--------------------------------------------------


csv/economic1.csv
File type: .csv
country,year,gdp,gdp_growth,inflation,unemployment,population,continent
United States,2023,25462,2.1,3.4,3.7,339,North America
United States,2022,23315,2.1,8.0,3.6,338,North America
United States,2021,22994,5.9,4.7,5.3,337,North America
China,2023,17963,5.2,2.5,5.2,1425,Asia
China,2022,17734,3.0,2.0,5.6,1423,Asia
China,2021,17734,8.4,1.0,5.1,1420,Asia
Germany,2023,4086,-0.3,6.2,3.0,83,Europe
Germany,2022,4072,1.8,8.7,3.1,83,Europe
Germany,2021,4257,2.6,3.1,3.6,83,Europe
Japan,2023,4230,1.9,3.2,2.4,125,Asia
Japan,2022,4235,1.0,2.5,2.6,125,Asia
Japan,2021,4936,2.1,-0.2,2.8,125,Asia
India,2023,3736,7.2,5.6,7.3,1426,Asia
India,2022,3385,9.1,6.7,7.9,1417,Asia
India,2021,3150,8.7,5.6,8.0,1410,Asia
United Kingdom,2023,3139,0.5,7.9,4.2,67,Europe
United Kingdom,2022,3070,4.1,9.6,3.9,67,Europe
United Kingdom,2021,3131,7.6,2.5,4.5,67,Europe
France,2023,2788,0.7,5.7,7.1,68,Europe
France,2022,2779,2.5,5.9,7.4,68,Europe
France,2021,2937,6.8,1.6,7.9,68,Europe
Brazil,2023,2173,2.9,4.6,8.5,216,South America
Brazil,2022,1920,2.9,9.3,9.3,215,South America
Brazil,2021,1609,5.0,8.3,13.2,214,South America
Italy,2023,2010,0.7,6.4,7.6,59,Europe
Italy,2022,2011,3.7,8.7,8.2,59,Europe
Italy,2021,2105,7.0,1.9,9.5,59,Europe
Canada,2023,2140,1.1,3.9,5.4,39,North America
Canada,2022,2154,3.4,6.8,5.3,39,North America
Canada,2021,1995,5.0,3.4,7.4,38,North America
South Korea,2023,1698,1.4,3.6,2.9,52,Asia
South Korea,2022,1667,2.6,5.1,3.0,52,Asia
South Korea,2021,1817,4.1,2.5,3.7,52,Asia
Russia,2023,2240,-2.1,7.4,4.3,144,Europe
Russia,2022,2215,-2.7,13.8,4.0,144,Europe
Russia,2021,1778,5.6,6.7,4.8,144,Europe
Australia,2023,1693,2.1,5.2,3.7,26,Oceania
Australia,2022,1675,3.7,6.6,3.7,26,Oceania
Australia,2021,1543,1.6,2.9,5.1,26,Oceania


--------------------------------------------------
File End
--------------------------------------------------


csv/economic2.csv
File type: .csv
country,year,gdp,gdp_growth,inflation,unemployment,population,continent
Spain,2023,1394,2.4,3.2,11.8,48,Europe
Spain,2022,1409,5.5,8.4,13.0,48,Europe
Spain,2021,1425,6.4,3.0,14.8,47,Europe
Mexico,2023,1490,3.2,4.7,2.9,128,North America
Mexico,2022,1414,3.9,7.9,3.3,127,North America
Mexico,2021,1274,5.7,5.7,4.1,126,North America
Indonesia,2023,1319,5.0,3.0,5.3,278,Asia
Indonesia,2022,1318,5.3,4.2,5.5,276,Asia
Indonesia,2021,1186,3.7,1.6,6.3,275,Asia
Netherlands,2023,991,0.1,4.1,3.5,18,Europe
Netherlands,2022,1009,4.3,11.6,3.6,18,Europe
Netherlands,2021,1018,4.9,2.7,3.8,17,Europe
Saudi Arabia,2023,1114,-0.8,2.3,5.1,36,Asia
Saudi Arabia,2022,1102,8.7,2.5,5.8,36,Asia
Saudi Arabia,2021,833,3.9,3.1,6.6,35,Asia
Turkey,2023,1155,4.5,64.8,9.4,85,Asia
Turkey,2022,907,5.6,72.3,10.4,85,Asia
Turkey,2021,720,11.4,19.6,12.0,84,Asia
Switzerland,2023,905,0.8,2.2,4.3,9,Europe
Switzerland,2022,818,2.6,2.8,4.2,9,Europe
Switzerland,2021,812,4.2,0.6,4.9,9,Europe

--------------------------------------------------
File End
--------------------------------------------------
